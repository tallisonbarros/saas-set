<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Proposta Comercial - {{ codigo }}</title>
</head>
<body>
  <div class="footer-left">
    <span>Gerado em {{ gerado_em_display }}</span>
    <span class="footer-sep">|</span>
    <span class="footer-site">www.setbrasil.com</span>
    <span class="footer-sep">|</span>
    <span class="footer-flag" aria-label="Bandeira do Brasil">
      <span class="flag-diamond"></span>
      <span class="flag-core"></span>
    </span>
  </div>

  <main class="proposal-doc">
    <section class="pdf-page page-cover">
      <header class="doc-header avoid-break">
        <div class="brand-bar">
          <div class="brand-pattern" aria-hidden="true"></div>
          <div class="brand-left">
            {% if logo_uri %}
              <img class="brand-logo" src="{{ logo_uri }}" alt="Logo SET">
            {% endif %}
          </div>
          <div class="brand-right">
            <div class="brand-meta-label">Status</div>
            <div class="status-badge {{ status_badge_class }}">{{ status_label|upper }}</div>
            <div class="brand-meta-label">Codigo da proposta</div>
            <div class="brand-code mono">{{ codigo }}</div>
          </div>
        </div>

        <div class="context-bar">
          <h1>PROPOSTA COMERCIAL</h1>
          <p class="context-subtitle">{{ proposta.nome|default:"-" }}</p>
          <div class="cover-summary-row">
            <span><strong>Cliente:</strong> {{ para_nome|default:"-" }}</span>
            {% for row in origem_rows %}
              {% if row.label == "Setor" or row.label == "Solicitante" or row.label == "Responsavel" %}
                <span><strong>{{ row.label }}:</strong> {{ row.value }}</span>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </header>

      <section class="cover-value-card avoid-break">
        <div class="cover-value-label">Valor da Proposta</div>
        <div class="cover-value">{{ valor_display }}</div>
        <div class="cover-meta-line">
          <span><strong>Status:</strong> {{ status_label }}</span>
          <span><strong>Codigo:</strong> <span class="mono">{{ codigo }}</span></span>
          <span><strong>Data:</strong> {{ criada_em_display }}</span>
          <span><strong>Prioridade:</strong> {{ proposta.prioridade }}</span>
        </div>
      </section>

      <section class="content-card section avoid-break">
        <h2 class="section-title">Resumo Descritivo</h2>
        <div class="description-flow">
          {% for block in descricao_blocks %}
            {% if block.type == "p" %}
              <p>{{ block.text }}</p>
            {% elif block.type == "ul" %}
              <ul class="description-list">
                {% for item in block.items %}
                  <li>{{ item }}</li>
                {% endfor %}
              </ul>
            {% endif %}
          {% endfor %}
        </div>
      </section>
    </section>

    <section class="pdf-page page-scope page-break-before">
      <section class="section-head">
        <h2 class="page-title">ESCOPO DO SERVICO</h2>
        <p class="page-subtitle">Resumo das atividades previstas.</p>
      </section>

      <section class="content-card section">
        <div class="scope-list">
          {% for atividade in atividades %}
            <article class="scope-item avoid-break">
              <h3>{{ atividade.nome }}</h3>
              {% if atividade.descricao %}
                <p>{{ atividade.descricao }}</p>
              {% endif %}
            </article>
          {% endfor %}
        </div>
      </section>
    </section>

    <section class="pdf-page page-tech page-break-before">
      <section class="section-head">
        <h2 class="page-title">INFORMACOES DO PROJETO</h2>
      </section>

      {% if origem_rows %}
        <section class="content-card section avoid-break">
          <h2 class="section-title">Origem Tecnica</h2>
          <table class="meta-table">
            <tbody>
              {% for row in origem_rows %}
                <tr>
                  <th>{{ row.label }}</th>
                  <td>{{ row.value }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </section>
      {% endif %}

      <section class="content-card section avoid-break">
        <h2 class="section-title">Identificacao</h2>
        <div class="table-grid">
          <table class="meta-table">
            <tbody>
              {% for row in identificacao_esquerda %}
                <tr>
                  <th>{{ row.label }}</th>
                  <td class="{% if row.mono %}mono{% endif %} {% if row.highlight %}value-strong{% endif %}">{{ row.value }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
          <table class="meta-table">
            <tbody>
              {% for row in identificacao_direita %}
                <tr>
                  <th>{{ row.label }}</th>
                  <td class="{% if row.mono %}mono{% endif %} {% if row.highlight %}value-strong{% endif %}">{{ row.value }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </section>

      {% if has_observacao %}
        <section class="content-card section observation-box avoid-break">
          <h2 class="section-title">Observacao</h2>
          <div class="description-flow">
            <p>{{ observacao }}</p>
          </div>
        </section>
      {% endif %}

      {% if anexos %}
        <section class="content-card section avoid-break">
          <h2 class="section-title">Anexos</h2>
          <table class="meta-table">
            <thead>
              <tr>
                <th>Tipo</th>
                <th>Arquivo</th>
              </tr>
            </thead>
            <tbody>
              {% for anexo in anexos %}
                <tr>
                  <td>{{ anexo.tipo }}</td>
                  <td class="mono">{{ anexo.nome }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </section>
      {% endif %}
    </section>

    <section class="pdf-page page-commercial page-break-before">
      <section class="section-head">
        <h2 class="page-title">CONDICOES COMERCIAIS</h2>
        <p class="page-subtitle">Resumo executivo de regras comerciais.</p>
      </section>

      <section class="commercial-grid">
        {% for bloco in condicoes_comerciais %}
          <article class="content-card section commercial-card avoid-break">
            <h3 class="commercial-title">{{ bloco.titulo }}</h3>
            {% if bloco.intro %}
              <p class="commercial-intro">{{ bloco.intro }}</p>
            {% endif %}
            {% if forloop.counter <= 3 %}
              <ul class="commercial-bullets">
                {% for item in bloco.itens %}
                  <li>{{ item }}</li>
                {% endfor %}
              </ul>
            {% else %}
              <p class="commercial-paragraph">
                {% for item in bloco.itens %}
                  {% if not forloop.first %} {% endif %}{{ item }}
                {% endfor %}
              </p>
            {% endif %}
          </article>
        {% endfor %}
      </section>
    </section>
  </main>
</body>
</html>
