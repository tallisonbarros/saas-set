{% extends "core/base.html" %}
{% load static %}

{% block title %}Detalhe{% endblock %}

{% block content %}
  <section class="card stack">
    <div>
      <h1 style="margin: 0 0 8px 0;">{{ proposta.nome }}</h1>
      <div class="muted">{{ proposta.descricao }}</div>
    </div>
    <div class="stack">
      <div><strong>Codigo:</strong> {{ proposta.codigo }}</div>
      <div><strong>Status:</strong> {{ proposta.get_status_display }}</div>
      <div><strong>Valor:</strong> R$ {{ proposta.valor }}</div>
      <div><strong>Criado em:</strong> {{ proposta.criado_em }}</div>
      {% if proposta.decidido_em %}
        <div><strong>Decidido em:</strong> {{ proposta.decidido_em }}</div>
      {% endif %}
      {% if proposta.aprovado_por %}
        <div><strong>Decidido por:</strong> {{ proposta.aprovado_por.username }}</div>
      {% endif %}
    </div>
    {% if proposta.status == "PENDENTE" %}
      <div class="detail-actions">
        <form method="post" action="{% url 'aprovar_proposta' proposta.pk %}">
          {% csrf_token %}
          <button class="btn btn-primary" type="submit">Aprovar</button>
        </form>
        <form method="post" action="{% url 'reprovar_proposta' proposta.pk %}">
          {% csrf_token %}
          <label for="id_observacao">Observacao</label>
          <textarea id="id_observacao" name="observacao"></textarea>
          <button class="btn btn-outline" type="submit">Reprovar</button>
        </form>
      </div>
    {% else %}
      {% if proposta.observacao_cliente %}
        <p><strong>Observacao do cliente:</strong> {{ proposta.observacao_cliente }}</p>
      {% endif %}
    {% endif %}
    <a class="nav-link" href="{% url 'propostas' %}">Voltar</a>
  </section>
{% endblock %}
